# ğŸ—ï¸ Architecture Overview

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    App.tsx (Root)                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚   Header   â”‚  â”‚  Status Bar  â”‚  â”‚  Theme Toggle  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EDITOR LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              EditorView.tsx (Main Editor)                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚           TipTap Editor (ProseMirror)              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         Document Schema (JSON)                â”‚  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Paragraph  â€¢ Heading  â€¢ Image  â€¢ Table    â”‚  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Code Block â€¢ Math     â€¢ Link  â€¢ List      â”‚  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FLOATING COMPONENTS    â”‚    â”‚     CUSTOM EXTENSIONS        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ FloatingInsertBtn  â”‚  â”‚    â”‚  â”‚   MathExtension.ts     â”‚ â”‚
â”‚  â”‚  (+) Menu          â”‚  â”‚    â”‚  â”‚   â€¢ math_inline        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â”‚   â€¢ math_block         â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚ FloatingFormatBar  â”‚  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Format Options    â”‚  â”‚    â”‚  â”‚  MathNodeView.tsx      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â”‚  KaTeX Rendering       â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STATE MANAGEMENT                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Zustand Store (editorStore.ts)              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ theme           â€¢ layoutMode    â€¢ isDirty       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ lastSaved       â€¢ wordCount     â€¢ UI state      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       UTILITIES LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ helpers.ts   â”‚  â”‚imageUtils.ts â”‚  â”‚    storage.ts        â”‚  â”‚
â”‚  â”‚ â€¢ debounce   â”‚  â”‚ â€¢ resize     â”‚  â”‚ â€¢ IndexedDB (idb)    â”‚  â”‚
â”‚  â”‚ â€¢ throttle   â”‚  â”‚ â€¢ crop       â”‚  â”‚ â€¢ LocalStorage       â”‚  â”‚
â”‚  â”‚ â€¢ wordCount  â”‚  â”‚ â€¢ validate   â”‚  â”‚ â€¢ autosave           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PERSISTENCE LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      IndexedDB                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚  articles store    â”‚  â”‚   autosave store        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ id              â”‚  â”‚   â€¢ articleId           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ title           â”‚  â”‚   â€¢ content (JSON)      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ content (JSON)  â”‚  â”‚   â€¢ timestamp           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ updatedAt       â”‚  â”‚                         â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   LocalStorage (Fallback)                â”‚   â”‚
â”‚  â”‚  â€¢ theme preference  â€¢ layout mode  â€¢ settings           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

### 1. User Input Flow
```
User Types â†’ TipTap Editor â†’ ProseMirror State Update
                                    â†“
                          onUpdate Callback
                                    â†“
                    Update Word Count (Zustand)
                                    â†“
                        Debounced Autosave (2s)
                                    â†“
                         Save to IndexedDB
```

### 2. Insert Content Flow
```
Click "+" Button â†’ FloatingInsertButton Menu
                                    â†“
                    User Selects Content Type
                                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“              â†“             â†“              â†“
    Image          Table         LaTeX         Heading
        â†“              â†“             â†“              â†“
    Upload &      Insert 3x3    Show Modal    Insert H2
    Process       Template      Enter TeX     Node
        â†“              â†“             â†“              â†“
    Insert         Insert        Render        Update
    Image Node     Table Node    with KaTeX    Document
```

### 3. Format Text Flow
```
User Selects Text â†’ Calculate Selection Position
                                    â†“
                    Show FloatingFormatToolbar
                                    â†“
                    User Clicks Format Button
                                    â†“
            TipTap Command (toggleBold, etc.)
                                    â†“
                        Update ProseMirror State
                                    â†“
                          Re-render Affected Text
```

### 4. Theme Change Flow
```
User Clicks Theme Button â†’ Update Zustand Store
                                    â†“
                    Calculate Effective Theme
                    (auto â†’ system preference)
                                    â†“
                Update <html> classList
                (theme-light / theme-dark)
                                    â†“
                    CSS Variables Update
                                    â†“
                Save to LocalStorage
```

### 5. Autosave Flow
```
Editor Content Changes â†’ onUpdate Triggered
                                    â†“
                        Set isDirty = true
                                    â†“
                    Debounce Timer (2000ms)
                                    â†“
            No Further Changes for 2s?
                                    â†“
                            Save to IndexedDB
                                    â†“
                Set lastSaved timestamp & isDirty = false
                                    â†“
                    Update Status Bar UI
```

## Component Hierarchy

```
App
â”œâ”€â”€ Header
â”‚   â”œâ”€â”€ Logo
â”‚   â”œâ”€â”€ StatusBar
â”‚   â”‚   â”œâ”€â”€ SaveIndicator
â”‚   â”‚   â””â”€â”€ WordCount
â”‚   â””â”€â”€ Toolbar
â”‚       â”œâ”€â”€ LayoutSelector
â”‚       â”œâ”€â”€ ThemeToggle
â”‚       â””â”€â”€ PublishButton
â”‚
â”œâ”€â”€ EditorView
â”‚   â”œâ”€â”€ TitleInput
â”‚   â””â”€â”€ TipTapEditor
â”‚       â”œâ”€â”€ EditorContent (ProseMirror)
â”‚       â”œâ”€â”€ FloatingInsertButton
â”‚       â”‚   â””â”€â”€ InsertMenu
â”‚       â”‚       â”œâ”€â”€ ImageOption
â”‚       â”‚       â”œâ”€â”€ TableOption
â”‚       â”‚       â”œâ”€â”€ LaTeXOption
â”‚       â”‚       â””â”€â”€ ... other options
â”‚       â””â”€â”€ FloatingFormatToolbar
â”‚           â”œâ”€â”€ BoldButton
â”‚           â”œâ”€â”€ ItalicButton
â”‚           â”œâ”€â”€ LinkButton
â”‚           â””â”€â”€ ... other format buttons
â”‚
â””â”€â”€ Footer
    â””â”€â”€ KeyboardShortcuts
```

## Extension Architecture

```
TipTap Editor
â”œâ”€â”€ StarterKit (Built-in)
â”‚   â”œâ”€â”€ Document
â”‚   â”œâ”€â”€ Paragraph
â”‚   â”œâ”€â”€ Text
â”‚   â”œâ”€â”€ Heading
â”‚   â”œâ”€â”€ Bold
â”‚   â”œâ”€â”€ Italic
â”‚   â”œâ”€â”€ Strike
â”‚   â”œâ”€â”€ Code
â”‚   â”œâ”€â”€ CodeBlock
â”‚   â”œâ”€â”€ Blockquote
â”‚   â”œâ”€â”€ BulletList
â”‚   â”œâ”€â”€ OrderedList
â”‚   â”œâ”€â”€ ListItem
â”‚   â”œâ”€â”€ HardBreak
â”‚   â”œâ”€â”€ HorizontalRule
â”‚   â””â”€â”€ History (Undo/Redo)
â”‚
â”œâ”€â”€ Additional Extensions
â”‚   â”œâ”€â”€ Table (with resize)
â”‚   â”œâ”€â”€ TableRow
â”‚   â”œâ”€â”€ TableCell
â”‚   â”œâ”€â”€ TableHeader
â”‚   â”œâ”€â”€ Link
â”‚   â”œâ”€â”€ Image
â”‚   â”œâ”€â”€ Underline
â”‚   â”œâ”€â”€ Highlight
â”‚   â”œâ”€â”€ Placeholder
â”‚   â””â”€â”€ Typography
â”‚
â””â”€â”€ Custom Extensions
    â”œâ”€â”€ MathInline (LaTeX)
    â””â”€â”€ MathBlock (LaTeX)
```

## State Management Structure

```
Zustand Store (editorStore.ts)
â”œâ”€â”€ Theme State
â”‚   â”œâ”€â”€ theme: 'light' | 'dark' | 'auto'
â”‚   â”œâ”€â”€ effectiveTheme: 'light' | 'dark'
â”‚   â””â”€â”€ setTheme(theme)
â”‚
â”œâ”€â”€ Layout State
â”‚   â”œâ”€â”€ layoutMode: 'default' | 'full-page' | 'book-like'
â”‚   â””â”€â”€ setLayoutMode(mode)
â”‚
â”œâ”€â”€ Draft State
â”‚   â”œâ”€â”€ isDirty: boolean
â”‚   â”œâ”€â”€ lastSaved: Date | null
â”‚   â”œâ”€â”€ setDirty(dirty)
â”‚   â””â”€â”€ setLastSaved(date)
â”‚
â”œâ”€â”€ UI State
â”‚   â”œâ”€â”€ showInsertMenu: boolean
â”‚   â”œâ”€â”€ insertMenuPosition: {x, y} | null
â”‚   â”œâ”€â”€ showFormatToolbar: boolean
â”‚   â”œâ”€â”€ formatToolbarPosition: {x, y, width, height} | null
â”‚   â””â”€â”€ setters for above
â”‚
â”œâ”€â”€ Image State
â”‚   â”œâ”€â”€ editingImage: string | null
â”‚   â””â”€â”€ setEditingImage(src)
â”‚
â””â”€â”€ Statistics
    â”œâ”€â”€ wordCount: number
    â””â”€â”€ setWordCount(count)
```

## File Organization Pattern

```
Component Structure:
ComponentName.tsx       â†’ React component logic
ComponentName.css       â†’ Component-specific styles

Example:
FloatingInsertButton.tsx
FloatingInsertButton.css
```

## Build & Bundle Structure

```
Development (npm run dev)
â”œâ”€â”€ Vite Dev Server (Port 3000)
â”œâ”€â”€ Hot Module Replacement (HMR)
â””â”€â”€ Source Maps

Production Build (npm run build)
â”œâ”€â”€ dist/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ index-[hash].js     (Main bundle)
â”‚   â”‚   â”œâ”€â”€ index-[hash].css    (Styles)
â”‚   â”‚   â””â”€â”€ vendor-[hash].js    (Dependencies)
â”‚   â””â”€â”€ ... other assets

Optimizations:
â€¢ Code splitting
â€¢ Tree shaking
â€¢ Minification
â€¢ CSS optimization
â€¢ Asset optimization
```

## Performance Considerations

```
Optimization Techniques:
â”œâ”€â”€ Debouncing
â”‚   â””â”€â”€ Autosave (2s delay)
â”‚
â”œâ”€â”€ Throttling
â”‚   â””â”€â”€ Scroll events
â”‚
â”œâ”€â”€ Lazy Loading
â”‚   â””â”€â”€ Images (loading="lazy")
â”‚
â”œâ”€â”€ Memoization
â”‚   â””â”€â”€ React components (where needed)
â”‚
â”œâ”€â”€ Virtual Scrolling
â”‚   â””â”€â”€ Large documents (future)
â”‚
â””â”€â”€ Code Splitting
    â””â”€â”€ Vendor chunks
```

---

This architecture provides:
- âœ… Separation of concerns
- âœ… Maintainable codebase
- âœ… Scalable structure
- âœ… Type safety
- âœ… Performance optimization
- âœ… Offline-first design
